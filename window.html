<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src self 'unsafe-inline'">
    <title>Window</title>
  </head>

  <body>
    <h1>Window</h1>
    <button onclick="onClickNewWindow()">New Window</button>
    <button onclick="onClickIncrement()">Increment</button>
    <span>Counter=<span id="counter">?</span></span>

    <script>
      window.poc.log(window.poc.getFromPreload());
      // window.poc.getCounter();
      window.postMessage({type:'getCounter'}, '*');   // Avoid * later

      const onClickNewWindow = () => {
        window.poc.log('sending poc/new-window');
        window.poc.newWindow();
      }

      const onClickIncrement = () => {
        window.poc.log('sending poc/increment');
        window.poc.increment();
      }

      window.poc.onUpdateCounter((event, arg) => {
        window.poc.log(`received poc/update-counter with ${arg}`);
        document.getElementById('counter').innerText = arg;
      });
    </script>
  </body>
</html>
